\begingroup \toks 0={macro:->[x=1cm,y=1cm,>=Latex] \par \def \a {2.2} \def \b {7.6} \par \draw [line width=0.6pt] (-0.6,-0.6) rectangle (9.5,4.8); \par \draw [->, line width=0.8pt] (0,0) -- (8.8,0) node[below right] {$x$}; \draw [->, line width=0.8pt] (0,0) -- (0,4.2) node[above] {$y$}; \par \def \fx (##1){ 2.55 + 0.95*sin(20*##1) - 0.45*cos(70*##1) - 0.08*(##1-5.0) } \par \fill [gray!25] (\a ,0) -- plot[domain=\a :\b , samples=200] (\x ,{ \fx (\x ) }) -- (\b ,0) -- cycle; \par \draw [line width=0.6pt] (\a ,0) -- (\a ,{ \fx (\a ) }); \draw [line width=0.6pt] (\b ,0) -- (\b ,{ \fx (\b ) }); \par \draw [line width=0.9pt] plot[domain=0.6:8.6, samples=240] (\x ,{ \fx (\x ) }); \par \node at ({0.5*(\a +\b )},1.5) {$\textbf {S}$}; \node [above right] at (8.15,{ \fx (8.15) }) {$f(x)$}; \par \node [below] at (\a ,0) {$a$}; \node [below] at (\b ,0) {$b$}; \par }\xdef \tikzexternallastkey {\the \toks 0 }\endgroup %
